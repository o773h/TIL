# 230116 ~ 230121 정리
# Spring
## SOLID
* #### 객체지향 설계 및 프로그래밍을 위한 다섯 가지 기본 원칙
### SRP : 단일 책임 원칙
* #### 한 클래스는 하나의 책임만 가져야 한다. (하나의 기능)
* #### 어떤 변화에 의해 클래스를 변경해야 하는 이유는 오직 하나 뿐이어야 한다.
### OCP : 개방-폐쇄 원칙
* #### 소프트웨어 요소는 확장에는 열려 있으나 변경에는 닫혀 있어야 한다.
* #### 추상화와 다형성이 OCP를 가능하게 하는 중요 메커니즘이다.
### LSP : 리스코프 치환 원칙
* #### 상위 타입의 객체를 하위타입의 객체로 치환해도 상위타입을 사용하는 프로그램은 정상적으로 동작해야 한다.
* #### 위반의 예시는 직사각형과 정사각형
### ISP : 인터페이스 분리 원칙
* #### 하나의 일반적인 인터페이스보다 여러 개의 구체적인 인터페이스가 낫다.
* #### SRP가 클래스의 단일책임을 강조한다면, ISP는 인터페이스의 단일책임을 강조한다.
### DIP : 의존관계 역전 원칙
* #### 프로그래머는 추상화에 의존해야지, 구체화에 의존하면 안된다.

### 스프링 컨테이너
```
ApplicationContext ac =
new AnnotationConfigApplicationContext(AppConfig.class);
```
* #### AppliactionContext <- 스프링 컨테이너, 인터페이스
* #### 어노테이션 기반의 자바 설정 클래스를 만듦(XML 기반으로도 생성 가능)

### 스프링 컨테이너 생성과정
1. #### 스프링 컨테이너 생성
2. #### 스프링 빈 등록
3. #### 스프링 빈 의존관계 설정 - 준비
4. #### 스프링 빈 의존관계 설정 - 완료

### 싱글톤 패턴
* #### 클래스의 인스턴스가 딱 1개만 생성되는 것을 보장하는 디자인 패턴
* #### 하지만 구현하는 코드 자체가 많이 들어간다.
* #### 의존관계상 클라이언트가 구체 클래스를 의존한다. (DIP 위반)
* #### 구체 클래스에 의존하여 OCP원칙을 위반할 가능성이 높다.
* #### 테스트 하기 어렵고, 내부 속성을 변경하거나 초기화하기 어렵다.
* #### private 생성자로 자식 클래스를 만들기 어렵다.

### 싱글톤 컨테이너
* #### 스프링 컨테이너는 싱글톤 패턴의 문제점을 해결하면서 객체 인스턴스를 싱글톤으로 관리한다.
* #### 스프링 컨테이너는 싱글톤 패턴을 적용하지 않아도 객체 인스턴스를 싱글톤으로 관리한다.
* #### 싱글톤 방식은 여러 클라이언트가 하나의 같은 객체 인스턴스를 공유하므로 객체는 상태를 stateful하게 설계하면 안된다.

```java
@Configuration
```
* #### @Configuraion을 붙이면 CGLIB 기술을 사용하여 싱글톤을 보장할 수 있다.
* #### 스프링 설정 정보는 @Configuration을 사용하자.

### 컴포넌트 스캔
* #### 설정 정보가 없어도 자동으로 스프링 빈을 등록한다.
* #### @Component가 붙은 모든 클래스를 스프링 빈으로 등록한다.

#### @Autowired : 의존관계 자동 주입
* #### 생성자 주입을 사용하자.
* #### 생성자는 하나일 경우, @Autowired를 생략해도 된다.
* #### 롬복을 사용할 경우,@RequiredArgsConstructor 기능을 사용하면 final이 붙은 필드를 모아서 생성자를 자동으로 만들어준다.

### 조회 빈이 2개 이상일 경우
* #### @Qualifier 사용 : 추가 구분자를 붙여주는 방법
* #### @Primary 사용 : 여러 빈이 매칭되면 우선권을 가진다.

### 빈 생명주기
* #### 스프링 빈은 객체를 생성하고 의존관계 주입이 다 끝난 다음에야 필요한 데이터를 사용할 수 있는 준비가 완료된다.
* #### 따라서 초기화 작업은 의존관계 주입이 모두 완료되고 난 다음에야 호출해야 한다.
* #### 콜백 메서드를 통해 초기화 시점을 알려준다.
* #### 스프링 컨테이너가 종료되기 직전에 소멸 콜백을 준다.
### 스프링 컨테이너 생성 -> 스프링 빈 생성 -> 초기화 콜백 -> 사용 -> 소멸전 콜백 -> 스프링 종료
* #### @PostConstruct, @PreDestroy를 사용하자.
* #### 외부 라이브러리에 적용할 경우, @Bean(initMethod="init",destoryMethod="close")처럼 지정하자.

### 싱글톤 빈에서 프로토타입 빈 사용하기
* #### 스프링이 제공하는 기능
* #### ObjectProvider, getObject()
* #### 자바 표준
* #### Provider, get()

### 스코프와 Provider
* #### 빈의 생성 지연에 사용할 수 있다.

### 스코프와 프록시
* #### CGLIB라는 라이브러리로 내 클래스를 상속받은 가짜 프록시 객체를 만들어서 주입한다.
* #### 의존관계 주입도 이 가짜 프록시 객체가 주입된다.
* #### 가짜 프록시 객체는 요청이 오면 그때 내부에서 진짜 빈을 요청하는 위임 로직이 들어있다.